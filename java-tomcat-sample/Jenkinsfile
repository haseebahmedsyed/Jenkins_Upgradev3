pipeline{
	agent any
	tools{
		maven 'maven'
	}
	stages{
		stage('Build Application'){
			steps{
				sh 'mvn -f java-tomcat-sample/pom.xml clean package'
			}
			post{
				success{
					echo "Archieving the artifacts.."
					archiveArtifacts artifacts: '**/*.war'
				}
			}
		}

		stage('Deploy-To-Staging-Environment'){
			steps{
				script{
				build job: 'DEPLOY-TO-STAGING-ENV-CODE-DSL'
				}
			}
		}

		stage('Deploy-To-Production-Environment'){
			steps{
				script{
				timeout(time:5, unit:'DAYS'){
					input message: 'Approve PRODUCTION Deployment?'
				}
				build job: 'DEPLOY-TO-PRODUCTION-ENV-CODE-DSL'
				}
			}
		}
	}
}
